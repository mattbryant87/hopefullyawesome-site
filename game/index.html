<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Hopefully Flappy</title>
<style>
body{
  margin:0;
  background:#0b0d14;
  overflow:hidden;
  font-family:system-ui;
  color:white;
}

canvas{
  display:block;
  margin:0 auto;
  background:#111;
}

#score{
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  font-size:28px;
  font-weight:bold;
}
#overlay{
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 18px;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(6px);
}

#card{
  width: min(420px, 92vw);
  border-radius: 18px;
  padding: 18px 16px 14px;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.08);
  box-shadow: 0 18px 60px rgba(0,0,0,0.55);
  text-align: center;
}

#gameover{
  font-size: 22px;
  font-weight: 800;
  letter-spacing: 0.02em;
  margin-bottom: 6px;
}

#finalScore{
  font-size: 44px;
  font-weight: 900;
  margin: 6px 0 14px;
}

.actions{
  display: flex;
  gap: 10px;
  justify-content: center;
  flex-wrap: wrap;
}

#restart, #shareBtn{
  padding: 12px 16px;
  border: none;
  border-radius: 14px;
  font-weight: 800;
  cursor: pointer;
}

#restart{
  background: #01FFFF;
  color: #000;
}

#shareBtn{
  background: rgba(255,255,255,0.14);
  color: #fff;
  border: 1px solid rgba(255,255,255,0.22);
}

#shareHint{
  margin-top: 10px;
  font-size: 12px;
  color: rgba(255,255,255,0.70);
}

</style>
</head>
<body>

<div id="score">0</div>
<div id="overlay">
  <div id="card">
    <div id="gameover">Game Over</div>
    <div id="finalScore">Score: 0</div>

    <div class="actions">
      <button id="shareBtn">Share Score</button>
      <button id="restart">Play Again</button>
    </div>

    <div id="shareHint"></div>
  </div>
</div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let gravity = 0.35;
let velocity = 0;
let birdY = canvas.height/2;
let birdX = 80;
let birdSize = 50;
let pipes = [];
let pipeWidth = 70;
let gap = 330;
let frame = 0;
let score = 0;
let gameOver = false;

const overlay = document.getElementById("overlay");
const finalScoreEl = document.getElementById("finalScore");
const shareBtn = document.getElementById("shareBtn");
const shareHint = document.getElementById("shareHint");

function showGameOver(){
  finalScoreEl.textContent = `Score: ${score}`;
  overlay.style.display = "flex";
}

function hideGameOver(){
  overlay.style.display = "none";
  shareHint.textContent = "";
}
  
const PIPE_COLORS = ["#01FFFF", "#F71E99"]; // blue then pink
let pipeCount = 0;
  
const logoPaths = [
  "/assets/smallville-circle.png",
  "/assets/digimon-circle.png",
  "/assets/sailormoon-circle.PNG",   // keep the capital PNG
  "/assets/ha-main-logo-2026.png"
];

const logos = logoPaths.map(src => {
  const img = new Image();
  img.src = src;
  return img;
});

let currentLogo = logos[Math.floor(Math.random() * logos.length)];

function pickRandomLogo(){
  currentLogo = logos[Math.floor(Math.random() * logos.length)];
}

function spawnPipe(){
  let topHeight = Math.random() * (canvas.height - gap - 200) + 50;

  const color = PIPE_COLORS[pipeCount % PIPE_COLORS.length];
  pipeCount++;

  pipes.push({
    x: canvas.width,
    top: topHeight,
    bottom: canvas.height - topHeight - gap,
    color,
    passed: false
  });
}

function resetGame(){
  velocity = 0;
  birdY = canvas.height/2;
  pipes = [];
  frame = 0;
  score = 0;
  gameOver = false;
  document.getElementById("score").innerText = 0;
  pickRandomLogo();
  document.getElementById("restart").style.display="none";
  hideGameOver();
}

function update(){
  if(gameOver) return;

  velocity += gravity;
  birdY += velocity;

  if(frame % 120 === 0){
    spawnPipe();
  }

  pipes.forEach(pipe=>{
    pipe.x -= 2.2;

    if(
      birdX < pipe.x + pipeWidth &&
      birdX + birdSize > pipe.x &&
      (birdY < pipe.top || birdY + birdSize > pipe.top + gap)
    ){
      gameOver = true;
      showGameOver();
      document.getElementById("restart").style.display="block";
    }

    if(!pipe.passed && pipe.x + pipeWidth < birdX){
      pipe.passed = true;
      score++;
      document.getElementById("score").innerText = score;
    }
  });

  if(birdY + birdSize > canvas.height || birdY < 0){
    gameOver = true;
    showGameOver();
    document.getElementById("restart").style.display="block";
  }

  frame++;
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  pipes.forEach(pipe=>{
    ctx.fillStyle = pipe.color;
    ctx.fillRect(pipe.x, 0, pipeWidth, pipe.top);
    ctx.fillRect(pipe.x, pipe.top + gap, pipeWidth, pipe.bottom);
});

  ctx.drawImage(currentLogo, birdX, birdY, birdSize, birdSize);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

document.addEventListener("keydown", ()=>{
  velocity = -9.5;
});

document.addEventListener("click", ()=>{
  velocity = -9.5;
});

async function shareScreenshot(){
  shareHint.textContent = "Preparing screenshotâ€¦";

// Dark overlay
ctx.fillStyle = "rgba(0,0,0,0.65)";
ctx.fillRect(0, 0, canvas.width, canvas.height);

ctx.textAlign = "center";

// --- Dynamic sizing based on canvas width ---
const centerX = canvas.width / 2;
const centerY = canvas.height / 2;

// Title scales with width
const titleSize = Math.min(canvas.width * 0.08, 42);
ctx.font = `bold ${titleSize}px system-ui`;
ctx.fillStyle = "#ffffff";
ctx.fillText("HOPEFULLY FLAPPY", centerX, centerY - 110);

// --- Badge rays behind score ---
const rayCount = 18;
const innerR = Math.min(canvas.width * 0.11, 70);
const outerR = Math.min(canvas.width * 0.22, 140);
const rayY = centerY + 5;

ctx.save();
ctx.translate(centerX, rayY);
ctx.globalAlpha = 0.22;
ctx.fillStyle = "rgba(1,255,255,1)";

for (let i = 0; i < rayCount; i++) {
  ctx.rotate((Math.PI * 2) / rayCount);
  ctx.beginPath();
  ctx.moveTo(innerR, -6);
  ctx.lineTo(outerR, 0);
  ctx.lineTo(innerR, 6);
  ctx.closePath();
  ctx.fill();
}
ctx.restore();
  
// Big score scales larger
const scoreSize = Math.min(canvas.width * 0.22, 120);
ctx.font = `bold ${scoreSize}px system-ui`;
ctx.fillStyle = "#01FFFF";
ctx.fillText(score, centerX, centerY + 10);

// Points label
const labelSize = Math.min(canvas.width * 0.06, 32);
ctx.font = `bold ${labelSize}px system-ui`;
ctx.fillStyle = "#ffffff";
ctx.fillText("POINTS!", centerX, centerY + 60);

// Challenge line
ctx.font = `20px system-ui`;
ctx.fillStyle = "rgba(255,255,255,0.85)";
ctx.fillText("Can you beat it?", centerX, centerY + 105);

// URL (subtle)
ctx.font = `18px system-ui`;
ctx.fillStyle = "rgba(255,255,255,0.6)";
ctx.fillText("hopefullyawesome.com/game", centerX, centerY + 140);
  // Make sure the last frame is drawn (usually already is)
  // draw();

  const blob = await new Promise(resolve => canvas.toBlob(resolve, "image/png"));

  if(!blob){
    shareHint.textContent = "Couldnâ€™t create screenshot. Try again.";
    return;
  }

  const file = new File([blob], `hopefully-flappy-score-${score}.png`, { type: "image/png" });

  const shareData = {
    title: "Hopefully Flappy",
    text: `I scored ${score} in Hopefully Flappy ðŸ˜…`,
    files: [file]
  };

  // Native share if supported
  if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
    try{
      await navigator.share(shareData);
      shareHint.textContent = "Shared!";
      return;
    }catch(e){
      // user canceled share â€“ no big deal
      shareHint.textContent = "Share canceled.";
      return;
    }
  }

  // Fallback: open the image in a new tab so you can Save/Share manually
  const url = URL.createObjectURL(blob);
  window.open(url, "_blank");
  shareHint.textContent = "Opened screenshot in a new tab (save/share it there).";
}

shareBtn.addEventListener("click", shareScreenshot);
  
document.getElementById("restart").onclick = resetGame;

loop();
</script>

</body>
</html>
